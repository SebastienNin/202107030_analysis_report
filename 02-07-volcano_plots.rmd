---
output: html_document
editor_options: 
  chunk_output_type: console
---

## Volcano plot of Fisher p-value and odd ratio

The following plot show, for each condition, the relation between -log10(p value of Fisher test) and the Fisher test odd ratio.

```{r volcano_qval_oddratio}
ggplot(fisher_test_rs_vs_notrs_full_table, aes(x = mean_odd_ratio_101, y = -log10(combined_pval_101), color = concordance_odd_ratio_101)) + 
  geom_point() + 
  facet_wrap(~ concordance_odd_ratio_101) +
  ggtitle("Volcano plot of the -log10 of combined pvalue for samples 101") + 
  ylab("-log10(combined pvalue of Fisher test)") +
  xlab("Mean odd ratio of Fisher test") + 
  labs(color = "Are odd ratio concordant") +
  scale_colour_discrete(labels = paste(levels(fisher_test_rs_vs_notrs_full_table$concordance_odd_ratio_101), table(fisher_test_rs_vs_notrs_full_table$concordance_odd_ratio_101)))

ggplot(fisher_test_rs_vs_notrs_full_table, aes(x = mean_odd_ratio_HSO, y = -log10(combined_pval_HSO), color = concordance_odd_ratio_HSO)) + 
  geom_point() + 
  facet_wrap(~ concordance_odd_ratio_HSO) +
  ggtitle("Volcano plot f the -log10 of combined pvalue for samples HSO") + 
  ylab("-log10(combined pvalue of Fisher test)") +
  xlab("Mean odd ratio of Fisher test") + 
  labs(color = "Are odd ratio concordant") +
  scale_colour_discrete(labels = paste(levels(fisher_test_rs_vs_notrs_full_table$concordance_odd_ratio_HSO), table(fisher_test_rs_vs_notrs_full_table$concordance_odd_ratio_HSO)))
```